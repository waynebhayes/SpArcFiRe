Helpers
['1237655463239155886.fits', '1237667735062577326.fits', '1237667735565238388.fits', '1237667911674233053.fits', '1237667911674691747.fits', '1237667912741355660.fits', '1237668310013640891.fits', '1237668311090200859.fits', '1237668589728366770.fits', '1237671124293910779.fits', '1237671124296532233.fits']

['1237655463239155886', '1237667735062577326', '1237667735565238388', '1237667911674233053', '1237667911674691747', '1237667912741355660', '1237668310013640891', '1237668311090200859', '1237668589728366770', '1237671124293910779', '1237671124296532233']
Does test-in exist? True
Does test-spout exist? False
@property
def x(self):
    return self._x1
            
@x.setter
def x(self, new_val):
    self._x1 = new_val


bye
hi
================================================================================================================================================================Classes
Testing default values of base class GalfitComponent--

component_type header
component_name 
component_number 0
param_prefix  
_parameters {'input_image': '.fits', 'output_image': '_galfit_out.fits', 'sigma_image': 'none', 'psf': '_psf.fits', 'psf_fine_sampling': 1, 'pixel_mask': '_star-rm.fits', 'constraint_file': 'none', 'region_to_fit': ntImageRegionToFit(x1=0, x2=256, y1=0, y2=256), 'convolution_box': ntConvolutionBox(x=52, y=52), 'mag_photo_zeropoint': 24.8, 'plate_scale': ntPlateScale(dx=0.396, dy=0.396), 'display_type': 'regular', 'optimize': 0}
input_image A) .fits                # Input data image (FITS file)
output_image B) _galfit_out.fits     # Output data image block
sigma_image C) none                 # Sigma image name (made from data if blank or 'none')
psf D) _psf.fits            # Input PSF image and (optional) diffusion kernel
psf_fine_sampling E) 1                    # PSF fine sampling factor relative to data
pixel_mask F) _star-rm.fits        # Bad pixel mask (FITS image or ASCII coord list)
constraint_file G) none                 # File with parameter constraints (ASCII file)
region_to_fit H) 0    256  0    256   # Image region to fit (xmin xmax ymin ymax)
convolution_box I) 52     52            # Size of the convolution box (x y)
mag_photo_zeropoint J) 24.8                 # Magnitude photometric zeropoint
plate_scale K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
display_type O) regular              # Display type (regular, curses, both)
optimize P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps
start_dict COMP_0
end_dict COMP_1
start_text # Component number: 0
end_text 10
_section_sep ================================================================================
Initializing header--

#  Input menu file: .in

#  

================================================================================
# IMAGE and GALFIT CONTROL PARAMETERS
A) .fits                # Input data image (FITS file)
B) _galfit_out.fits     # Output data image block
C) none                 # Sigma image name (made from data if blank or 'none')
D) _psf.fits            # Input PSF image and (optional) diffusion kernel
E) 1                    # PSF fine sampling factor relative to data
F) _star-rm.fits        # Bad pixel mask (FITS image or ASCII coord list)
G) none                 # File with parameter constraints (ASCII file)
H) 0    256  0    256   # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------


Reading header from file via list--

#  Input menu file: .in

#  

================================================================================
# IMAGE and GALFIT CONTROL PARAMETERS
A) /home/portmanm/run6_1000_galfit_two_fit/sparcfire-in/1237667783385612464.fits # Input data image (FITS file)
B) /home/portmanm/run6_1000_galfit_two_fit/sparcfire-tmp/galfits/1237667783385612464_out.fits # Output data image block
C) none                 # Sigma image name (made from data if blank or 'none')
D) none                 # Input PSF image and (optional) diffusion kernel
E) 1                    # PSF fine sampling factor relative to data
F) /home/portmanm/run6_1000_galfit_two_fit/sparcfire-tmp/galfit_masks/1237667783385612464_star-rm.fits # Bad pixel mask (FITS image or ASCII coord list)
G) none                 # File with parameter constraints (ASCII file)
H) 43   111  43   111   # Image region to fit (xmin xmax ymin ymax)
I) 50     50            # Size of the convolution box (x y)
J) 24.800               # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------


Printing header to file /home/portmanm/sparcfire_matt/GalfitModule/RegTest/TestOutput/UnitTest_header.txt--


Reading header from file via dict --

#  Input menu file: .in

#  

================================================================================
# IMAGE and GALFIT CONTROL PARAMETERS
A) /home/portmanm/run6_1000_galfit_two_fit/sparcfire-in/1237667783385612464.fits # Input data image (FITS file)
B) /home/portmanm/run6_1000_galfit_two_fit/sparcfire-tmp/galfits/1237667783385612464_out.fits # Output data image block
C) none                 # Sigma image name (made from data if blank or 'none')
D) none                 # Input PSF image and (optional) diffusion kernel
E) 1                    # PSF fine sampling factor relative to data
F) /home/portmanm/run6_1000_galfit_two_fit/sparcfire-tmp/galfit_masks/1237667783385612464_star-rm.fits # Bad pixel mask (FITS image or ASCII coord list)
G) none                 # File with parameter constraints (ASCII file)
H) 36   98   37   99    # Image region to fit (xmin xmax ymin ymax)
I) 51     50            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------


Updating Sersic (as an example GalfitComponent) from kwargs--
 # Component number: 1
 0) sersic              # Component type
 1) 25 25       0  0    # Position x, y
 3) 15.0        1       # Integrated magnitude
 4) 10.0101     1       # R_e (effective radius)   [pix]
 5) 4.52        1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.6         1       # Axis ratio (b/a)
 10) 90.01      1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Defaults--
 {'_sersic': 'sersic', 'position': ntMultiParameter(x=100.0, y=100.0), 'magnitude': 16.0, 'effective_radius': 10.0, 'sersic_index': 1.0, 'axis_ratio': 0.5, 'position_angle': 90.0, 'skip': 0}

Modifying magnitude directly--
 # Component number: 1
 0) sersic              # Component type
 1) 100 100     0  0    # Position x, y
 3) 555555.0    1       # Integrated magnitude
 4) 10.0        1       # R_e (effective radius)   [pix]
 5) 1.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5         1       # Axis ratio (b/a)
 10) 90.0       1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

From file helper, list--
 # Component number: 1
 0) sersic              # Component type
 1) 76.7000 76.5000     # Position x, y
 3) 12.9567     1       # Integrated magnitude
 4) 18.5147     1       # R_e (effective radius)   [pix]
 5) 0.6121      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.3943      1       # Axis ratio (b/a)
 10) -48.3372   1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Sending to file--
 # Component number: 1
 0) sersic              # Component type
 1) 76.7000 76.5000     # Position x, y
 3) 12.9567     1       # Integrated magnitude
 4) 18.5147     1       # R_e (effective radius)   [pix]
 5) 0.6121      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.3943      1       # Axis ratio (b/a)
 10) -48.3372   1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

From file helper, dict--
 # Component number: 1
 0) sersic              # Component type
 1) 67.3796 67.7662 0  0 # Position x, y
 3) 13.1936     1       # Integrated magnitude
 4) 15.5266     1       # R_e (effective radius)   [pix]
 5) 0.3433      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.6214      1       # Axis ratio (b/a)
 10) -19.1534   1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

To pandas--
           magnitude_sersic_1  ...  skip_sersic_1
sersic_1             13.1936  ...            0.0

[1 rows x 8 columns]

From pandas, modified parameters--
 # Component number: 1
 0) sersic              # Component type
 1) 67.3796 67.7662 0  0 # Position x, y
 3) 111.0       1       # Integrated magnitude
 4) 112.0       1       # R_e (effective radius)   [pix]
 5) 113.0       1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.6214      1       # Axis ratio (b/a)
 10) -19.1534   1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

From log line--
 # Component number: 1
 0) sersic              # Component type
 1) 62.9000 62.9000 0  0 # Position x, y
 3) 14.11       1       # Integrated magnitude
 4) 13.75       1       # R_e (effective radius)   [pix]
 5) 0.3         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.63        1       # Axis ratio (b/a)
 10) 60.82      1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Defaults--
 {'_power': 'power', 'inner_rad': 0.0, 'outer_rad': 10.0, 'cumul_rot': 90.0, 'powerlaw_index': 0.5, 'inclination': 0.0, 'sky_position_angle': 90.0}

Modifying powerlaw_index directly--
 R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 10.0        0       # Spiral outer radius [pixels]
R3) 90.0        1       # Cumul. rotation out to outer radius [degrees]
R4) 555555.0    1       # Asymptotic spiral powerlaw
R9) 0.0         1       # Inclination to L.o.S. [degrees]
R10) 90.0       1       # Sky position angle

From file helper, list--
 R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 42.02       0       # Spiral outer radius [pixels]
R3) 595.0912    1       # Cumul. rotation out to outer radius [degrees]
R4) -0.1961     1       # Asymptotic spiral powerlaw
R9) 49.1328     1       # Inclination to L.o.S. [degrees]
R10) 72.0972    1       # Sky position angle

Sending to file--
 R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 42.02       0       # Spiral outer radius [pixels]
R3) 595.0912    1       # Cumul. rotation out to outer radius [degrees]
R4) -0.1961     1       # Asymptotic spiral powerlaw
R9) 49.1328     1       # Inclination to L.o.S. [degrees]
R10) 72.0972    1       # Sky position angle

From file helper, dict--
 R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 22.011      0       # Spiral outer radius [pixels]
R3) 79.0069     1       # Cumul. rotation out to outer radius [degrees]
R4) -2.3697     1       # Asymptotic spiral powerlaw
R9) 40.8043     1       # Inclination to L.o.S. [degrees]
R10) 24.301     1       # Sky position angle

To pandas--
          inner_rad_power_2  ...  sky_position_angle_power_2
power_2                0.0  ...                   24.301001

[1 rows x 6 columns]

From pandas, modified parameters--
 R0) power               # Component type
R1) 111.0       0       # Spiral inner radius [pixels]
R2) 112.0       0       # Spiral outer radius [pixels]
R3) 113.0       1       # Cumul. rotation out to outer radius [degrees]
R4) -2.3697     1       # Asymptotic spiral powerlaw
R9) 40.8043     1       # Inclination to L.o.S. [degrees]
R10) 24.301     1       # Sky position angle

From log line--
 R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 23.51       0       # Spiral outer radius [pixels]
R3) 219.64      1       # Cumul. rotation out to outer radius [degrees]
R4) -0.16       1       # Asymptotic spiral powerlaw
R9) -44.95      1       # Inclination to L.o.S. [degrees]
R10) -15.65     1       # Sky position angle

Defaults--
 {'F1': ntFourier(amplitude=0.05, phase_angle=45.0), 'F3': ntFourier(amplitude=0.05, phase_angle=25.0), 'skip': 0}

Modifying F1 directly--
 F1) 555 555     1  1    # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.0500 25   1  1    # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

From file helper, list--
 F1) 0.2721 -56.9126     # Azim. Fourier mode 1, amplitude, & phase angle
F3) -0.0690 -31.8175    # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Sending to file--
 F1) 0.2721 -56.9126     # Azim. Fourier mode 1, amplitude, & phase angle
F3) -0.0690 -31.8175    # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

From file helper, dict--
 F1) 0.1449 44.3015 1  1 # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.0979 -35.1366 1  1 # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

To pandas--
            F1_amplitude_fourier_2  ...  skip_fourier_2
fourier_2                  0.1449  ...             0.0

[1 rows x 5 columns]

From pandas, modified parameters--
 F1) 111 112     1  1    # Azim. Fourier mode 1, amplitude, & phase angle
F3) 113 -35.1366 1  1   # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

From log line--
 F1) 0.0600 -6.6700 1  1 # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.0500 0.1800 1  1  # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Defaults--
 {'_sky': 'sky', 'sky_background': 1000.0, 'dsky_dx': 0.0, 'dsky_dy': 0.0, 'skip': 0}

Modifying sky_background directly--
 # Component number: 3
 0) sky                 # Component type
 1) 555555.0    1       # Sky background at center of fitting region [ADUs]
 2) 0.0         1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.0         1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

From file helper, list--
 # Component number: 3
 0) sky                 # Component type
 1) 1112.1005   1       # Sky background at center of fitting region [ADUs]
 2) 0.0126      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.0181      1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Sending to file--
 # Component number: 3
 0) sky                 # Component type
 1) 1112.1005   1       # Sky background at center of fitting region [ADUs]
 2) 0.0126      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.0181      1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

From file helper, dict--
 # Component number: 3
 0) sky                 # Component type
 1) 1133.4166   1       # Sky background at center of fitting region [ADUs]
 2) 0.0119      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) -0.0131     1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

To pandas--
        sky_background_sky_3  dsky_dx_sky_3  dsky_dy_sky_3  skip_sky_3
sky_3           1133.416626         0.0119        -0.0131         0.0

From pandas, modified parameters--
 # Component number: 3
 0) sky                 # Component type
 1) 111.0       1       # Sky background at center of fitting region [ADUs]
 2) 112.0       1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 113.0       1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

From log line--
 # Component number: 3
 0) sky                 # Component type
 1) 1130.51     1       # Sky background at center of fitting region [ADUs]
 2) -0.0492     1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.01        1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Checking load_all_components() function--

header
#  Input menu file: .in

#  

================================================================================
# IMAGE and GALFIT CONTROL PARAMETERS
A) .fits                # Input data image (FITS file)
B) _galfit_out.fits     # Output data image block
C) none                 # Sigma image name (made from data if blank or 'none')
D) _psf.fits            # Input PSF image and (optional) diffusion kernel
E) 1                    # PSF fine sampling factor relative to data
F) _star-rm.fits        # Bad pixel mask (FITS image or ASCII coord list)
G) none                 # File with parameter constraints (ASCII file)
H) 0    256  0    256   # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

sersic
# Component number: 1
 0) sersic              # Component type
 1) 100 100     0  0    # Position x, y
 3) 16.0        1       # Integrated magnitude
 4) 10.0        1       # R_e (effective radius)   [pix]
 5) 1.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5         1       # Axis ratio (b/a)
 10) 90.0       1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

power
R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 10.0        0       # Spiral outer radius [pixels]
R3) 90.0        1       # Cumul. rotation out to outer radius [degrees]
R4) 0.5         1       # Asymptotic spiral powerlaw
R9) 0.0         1       # Inclination to L.o.S. [degrees]
R10) 90.0       1       # Sky position angle

fourier
F1) 0.0500 45   1  1    # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.0500 25   1  1    # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

sky
# Component number: 2
 0) sky                 # Component type
 1) 1000.0      1       # Sky background at center of fitting region [ADUs]
 2) 0.0         1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.0         1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)


#  Input menu file: .in

#  

================================================================================
# IMAGE and GALFIT CONTROL PARAMETERS
A) .fits                # Input data image (FITS file)
B) _galfit_out.fits     # Output data image block
C) none                 # Sigma image name (made from data if blank or 'none')
D) _psf.fits            # Input PSF image and (optional) diffusion kernel
E) 1                    # PSF fine sampling factor relative to data
F) _star-rm.fits        # Bad pixel mask (FITS image or ASCII coord list)
G) none                 # File with parameter constraints (ASCII file)
H) 0    256  0    256   # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 100 100     0  0    # Position x, y
 3) 16.0        1       # Integrated magnitude
 4) 10.0        1       # R_e (effective radius)   [pix]
 5) 1.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5         1       # Axis ratio (b/a)
 10) 90.0       1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 10.0        0       # Spiral outer radius [pixels]
R3) 90.0        1       # Cumul. rotation out to outer radius [degrees]
R4) 0.5         1       # Asymptotic spiral powerlaw
R9) 0.0         1       # Inclination to L.o.S. [degrees]
R10) 90.0       1       # Sky position angle
F1) 0.0500 45   1  1    # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.0500 25   1  1    # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sky                 # Component type
 1) 1000.0      1       # Sky background at center of fitting region [ADUs]
 2) 0.0         1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.0         1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)


   magnitude_sersic_1  effective_radius_sersic_1  ...  dsky_dy_sky_2  skip_sky_2
0                16.0                       10.0  ...            0.0         0.0

[1 rows x 23 columns]
#  Input menu file: .in

#  

================================================================================
# IMAGE and GALFIT CONTROL PARAMETERS
A) tester.fits          # Input data image (FITS file)
B) tester_galfit_out.fits # Output data image block
C) none                 # Sigma image name (made from data if blank or 'none')
D) tester_psf.fits      # Input PSF image and (optional) diffusion kernel
E) 1                    # PSF fine sampling factor relative to data
F) tester_star-rm.fits  # Bad pixel mask (FITS image or ASCII coord list)
G) none                 # File with parameter constraints (ASCII file)
H) 0    256  0    256   # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 25 25       0  0    # Position x, y
 3) 16.0        1       # Integrated magnitude
 4) 10.0        1       # R_e (effective radius)   [pix]
 5) 1.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5         1       # Axis ratio (b/a)
 10) 90.0       1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 25 25       0  0    # Position x, y
 3) 16.0        1       # Integrated magnitude
 4) 10.0        1       # R_e (effective radius)   [pix]
 5) 1.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5         1       # Axis ratio (b/a)
 10) 90.0       1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 10.0        0       # Spiral outer radius [pixels]
R3) 90.0        1       # Cumul. rotation out to outer radius [degrees]
R4) 0.5         1       # Asymptotic spiral powerlaw
R9) 0.0         1       # Inclination to L.o.S. [degrees]
R10) 90.0       1       # Sky position angle
F1) 0.0500 45   1  1    # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.0500 25   1  1    # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1000.0      1       # Sky background at center of fitting region [ADUs]
 2) 0.0         1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.0         1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)


   magnitude_sersic_1  effective_radius_sersic_1  ...  dsky_dy_sky_3  skip_sky_3
0                16.0                       10.0  ...            0.0         0.0

[1 rows x 31 columns]
These are feedme -> output
ignoring filepaths for reg tests...

G) none                 # File with parameter constraints (ASCII file)
H) 7    59   7    59    # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 33.1654 32.8765     # Position x, y
 3) 14.0        1       # Integrated magnitude
 4) 2.6         1       # R_e (effective radius)   [pix]
 5) 4.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.9494      1       # Axis ratio (b/a)
 10) 120.1004   1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 33.1700 32.8800     # Position x, y
 3) 13.25       1       # Integrated magnitude
 4) 6.0         1       # R_e (effective radius)   [pix]
 5) 1.01        1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.6         1       # Axis ratio (b/a)
 10) -59.27     1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 2.4184      0       # Spiral outer radius [pixels]
R3) -133.1071   1       # Cumul. rotation out to outer radius [degrees]
R4) 0.7587      1       # Asymptotic spiral powerlaw
R9) -28.5901    1       # Inclination to L.o.S. [degrees]
R10) 34.5243    1       # Sky position angle
F1) 0.0500 45           # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.0500 25           # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1102.81     1       # Sky background at center of fitting region [ADUs]
 2) -0.118      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.116       1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

********************************************************************************
********************************************************************************
G) none                 # File with parameter constraints (ASCII file)
H) 7    59   7    59    # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 33.1654 32.8765 0  0 # Position x, y
 3) 13.9763     1       # Integrated magnitude
 4) 5.7642      1       # R_e (effective radius)   [pix]
 5) 1.4663      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.8585      1       # Axis ratio (b/a)
 10) -62.3972   1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 33.1700 32.8800 0  0 # Position x, y
 3) 14.1274     1       # Integrated magnitude
 4) 5.8773      1       # R_e (effective radius)   [pix]
 5) 0.4464      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.85        1       # Axis ratio (b/a)
 10) 45.2593    1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 2.4184      0       # Spiral outer radius [pixels]
R3) -0.1242     1       # Cumul. rotation out to outer radius [degrees]
R4) 5.0593      1       # Asymptotic spiral powerlaw
R9) -26.1161    1       # Inclination to L.o.S. [degrees]
R10) 66.8938    1       # Sky position angle
F1) 0.1502 -75.3559 1  1 # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.1086 57.6034 1  1 # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1103.899    1       # Sky background at center of fitting region [ADUs]
 2) -0.0171     1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.0064      1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

These are feedme -> output
ignoring filepaths for reg tests...

G) none                 # File with parameter constraints (ASCII file)
H) 7    79   8    80    # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8000              # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 43.4409 43.8034     # Position x, y
 3) 12.9125     1       # Integrated magnitude
 4) 8.7045      1       # R_e (effective radius)   [pix]
 5) 1.1536      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.7504      1       # Axis ratio (b/a)
 10) 80.8433    1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sky                 # Component type
 1) 1145.1249   1       # Sky background at center of fitting region [ADUs]
 2) 0.0015      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) -0.0099     1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

dict_keys(['header', 'bulge', 'sky'])
********************************************************************************
********************************************************************************
Reading in from file, WITHOUT initializing a new container.
G) none                 # File with parameter constraints (ASCII file)
H) 7    79   8    80    # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 43.4409 43.8034 0  0 # Position x, y
 3) 15.7372     1       # Integrated magnitude
 4) 2.3043      1       # R_e (effective radius)   [pix]
 5) 0.7937      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5962      1       # Axis ratio (b/a)
 10) -51.042    1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 43.4400 43.8000 0  0 # Position x, y
 3) 13.1393     1       # Integrated magnitude
 4) 9.5027      1       # R_e (effective radius)   [pix]
 5) 0.5848      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.7859      1       # Axis ratio (b/a)
 10) -11.2164   1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 3.9079      0       # Spiral outer radius [pixels]
R3) -394.8103   1       # Cumul. rotation out to outer radius [degrees]
R4) 0.2978      1       # Asymptotic spiral powerlaw
R9) -43.178     1       # Inclination to L.o.S. [degrees]
R10) 170.2729   1       # Sky position angle
F1) 0.0640 140.5367 1  1 # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.0466 20.5166 1  1 # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1146.3428   1       # Sky background at center of fitting region [ADUs]
 2) 0.0103      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) -0.004      1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Expect new components keys to *not* have disk or arms since they are not in the first file.
dict_keys(['header', 'bulge', 'sersic', 'power', 'fourier', 'sky'])

Reading in from file, after initializing a new container and checking the keys (expect disk, arms).
dict_keys(['header', 'bulge', 'disk', 'arms', 'fourier', 'sky'])

These are feedme -> output
ignoring filepaths for reg tests...

G) none                 # File with parameter constraints (ASCII file)
H) 17   81   18   82    # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 48.9445 49.6255     # Position x, y
 3) 14.0        1       # Integrated magnitude
 4) 2.7439      1       # R_e (effective radius)   [pix]
 5) 4.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.9409      1       # Axis ratio (b/a)
 10) 161.0977   1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 48.9400 49.6300     # Position x, y
 3) 13.82       1       # Integrated magnitude
 4) 8.47        1       # R_e (effective radius)   [pix]
 5) 1.38        1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.6         1       # Axis ratio (b/a)
 10) -49.1      1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1108.49     1       # Sky background at center of fitting region [ADUs]
 2) 0.0163      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) -0.0026     1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

********************************************************************************
********************************************************************************
G) none                 # File with parameter constraints (ASCII file)
H) 17   81   18   82    # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 48.9445 49.6255 0  0 # Position x, y
 3) 16.0004     1       # Integrated magnitude
 4) 2.7602      1       # R_e (effective radius)   [pix]
 5) 0.6979      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.8314      1       # Axis ratio (b/a)
 10) 79.4237    1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 48.9400 49.6300 0  0 # Position x, y
 3) 14.0612     1       # Integrated magnitude
 4) 9.6966      1       # R_e (effective radius)   [pix]
 5) 0.8365      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.7612      1       # Axis ratio (b/a)
 10) -43.8476   1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1108.7705   1       # Sky background at center of fitting region [ADUs]
 2) 0.0163      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) -0.0028     1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Key: header
Key: bulge
Key: disk
Key: arms
Key: fourier
Key: sky

G) none                 # File with parameter constraints (ASCII file)
H) 0    256  0    256   # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 25 25       0  0    # Position x, y
 3) 16.0        1       # Integrated magnitude
 4) 10.0        1       # R_e (effective radius)   [pix]
 5) 1.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5         1       # Axis ratio (b/a)
 10) 90.0       1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 25 25       0  0    # Position x, y
 3) 16.0        1       # Integrated magnitude
 4) 10.0        1       # R_e (effective radius)   [pix]
 5) 1.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5         1       # Axis ratio (b/a)
 10) 90.0       1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 10.0        0       # Spiral outer radius [pixels]
R3) 90.0        1       # Cumul. rotation out to outer radius [degrees]
R4) 0.5         1       # Asymptotic spiral powerlaw
R9) 0.0         1       # Inclination to L.o.S. [degrees]
R10) 90.0       1       # Sky position angle
F1) 0.0500 45   1  1    # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.0500 25   1  1    # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1000.0      1       # Sky background at center of fitting region [ADUs]
 2) 0.0         1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.0         1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Checking the bad example
Galfit failed this run!
# Component number: 1
 0) sersic              # Component type
 1) 100 100     0  0    # Position x, y
 3) 16.0        1       # Integrated magnitude
 4) 10.0        1       # R_e (effective radius)   [pix]
 5) 1.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5         1       # Axis ratio (b/a)
 10) 90.0       1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 100 100     0  0    # Position x, y
 3) 16.0        1       # Integrated magnitude
 4) 10.0        1       # R_e (effective radius)   [pix]
 5) 1.0         1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5         1       # Axis ratio (b/a)
 10) 90.0       1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 10.0        0       # Spiral outer radius [pixels]
R3) 90.0        1       # Cumul. rotation out to outer radius [degrees]
R4) 0.5         1       # Asymptotic spiral powerlaw
R9) 0.0         1       # Inclination to L.o.S. [degrees]
R10) 90.0       1       # Sky position angle

F1) 0.0500 45   1  1    # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.0500 25   1  1    # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1000.0      1       # Sky background at center of fitting region [ADUs]
 2) 0.0         1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.0         1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Did the bad example succeed? False
********************************************************************************
********************************************************************************
And now checking the 'good' example (these should all be updated from the default values)

(this should produce failure text since we didn't store text)
Galfit output text not stored.
Set keyword argument 'store' = True in OutputContainer call to store it or otherwise pass the text as an argument to the object when converting to string.

Now it should succeed... Re-printing output text.

Iteration : 6     Chi2nu: 3.205e-01     dChi2/Chi2: -2.24e-08   alamda: 1e+02
     sersic    : (  [67.38],  [67.77])  13.19     15.54    0.34    0.62   -19.23
     sersic    : (  [67.38],  [67.77])  14.58      8.89    1.56    0.68    30.23
       power   :     [0.00]   [22.01]   78.86     -2.39     ---   39.74    22.52
       fourier : (1:  0.15,   46.48)   (3:  0.10,  -33.06)
     sky       : [ 67.00,  68.00]  1133.43  1.16e-02  -1.35e-02
    COUNTDOWN = 6

    Iteration : 7     Chi2nu: 3.205e-01     dChi2/Chi2: -2.24e-08   alamda: 1e+03
     sersic    : (  [67.38],  [67.77])  13.19     15.54    0.34    0.62   -19.23
     sersic    : (  [67.38],  [67.77])  14.58      8.89    1.56    0.68    30.23
       power   :     [0.00]   [22.01]   78.86     -2.39     ---   39.74    22.52
       fourier : (1:  0.15,   46.48)   (3:  0.10,  -33.06)
     sky       : [ 67.00,  68.00]  1133.43  1.16e-02  -1.35e-02
    COUNTDOWN = 5

    Iteration : 8     Chi2nu: 3.205e-01     dChi2/Chi2: -2.24e-08   alamda: 1e+04
     sersic    : (  [67.38],  [67.77])  13.19     15.54    0.34    0.62   -19.23
     sersic    : (  [67.38],  [67.77])  14.58      8.89    1.56    0.68    30.23
       power   :     [0.00]   [22.01]   78.86     -2.39     ---   39.74    22.52
       fourier : (1:  0.15,   46.48)   (3:  0.10,  -33.06)
     sky       : [ 67.00,  68.00]  1133.43  1.16e-02  -1.35e-02
    COUNTDOWN = 4

    Iteration : 9     Chi2nu: 3.205e-01     dChi2/Chi2: -3.33e-08   alamda: 1e+03
     sersic    : (  [67.38],  [67.77])  13.19     15.54    0.34    0.62   -19.23
     sersic    : (  [67.38],  [67.77])  14.58      8.89    1.56    0.68    30.23
       power   :     [0.00]   [22.01]   78.86     -2.39     ---   39.74    22.52
       fourier : (1:  0.15,   46.48)   (3:  0.10,  -33.06)
     sky       : [ 67.00,  68.00]  1133.43  1.16e-02  -1.35e-02
    COUNTDOWN = 3

    Iteration : 10    Chi2nu: 3.205e-01     dChi2/Chi2: -3.33e-08   alamda: 1e+04
     sersic    : (  [67.38],  [67.77])  13.19     15.54    0.34    0.62   -19.23
     sersic    : (  [67.38],  [67.77])  14.58      8.89    1.56    0.68    30.23
       power   :     [0.00]   [22.01]   78.86     -2.39     ---   39.74    22.52
       fourier : (1:  0.15,   46.48)   (3:  0.10,  -33.06)
     sky       : [ 67.00,  68.00]  1133.43  1.16e-02  -1.35e-02
    COUNTDOWN = 2

    Iteration : 11    Chi2nu: 3.205e-01     dChi2/Chi2: -8.01e-08   alamda: 1e+03
     sersic    : (  [67.38],  [67.77])  13.19     15.54    0.34    0.62   -19.23
     sersic    : (  [67.38],  [67.77])  14.58      8.89    1.56    0.68    30.23
       power   :     [0.00]   [22.01]   78.86     -2.39     ---   39.74    22.52
       fourier : (1:  0.15,   46.48)   (3:  0.10,  -33.06)
     sky       : [ 67.00,  68.00]  1133.43  1.16e-02  -1.35e-02
    COUNTDOWN = 1

    Iteration : 12    Chi2nu: 3.205e-01     dChi2/Chi2: 1.75e-08    alamda: 1e+04
     sersic    : (  [67.38],  [67.77])  13.19     15.54    0.34    0.62   -19.23
     sersic    : (  [67.38],  [67.77])  14.58      8.89    1.56    0.68    30.23
       power   :     [0.00]   [22.01]   78.86     -2.39     ---   39.74    22.52
       fourier : (1:  0.15,   46.48)   (3:  0.10,  -33.06)
     sky       : [ 67.00,  68.00]  1133.43  1.16e-02  -1.35e-02
    COUNTDOWN = 0


    Fit summary is now being saved into `fit.log'.

    

# Component number: 1
 0) sersic              # Component type
 1) 67.3800 67.7700 0  0 # Position x, y
 3) 13.19       1       # Integrated magnitude
 4) 15.54       1       # R_e (effective radius)   [pix]
 5) 0.34        1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.62        1       # Axis ratio (b/a)
 10) -19.23     1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 67.3800 67.7700 0  0 # Position x, y
 3) 14.58       1       # Integrated magnitude
 4) 8.89        1       # R_e (effective radius)   [pix]
 5) 1.56        1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.68        1       # Axis ratio (b/a)
 10) 30.23      1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 22.01       0       # Spiral outer radius [pixels]
R3) 78.86       1       # Cumul. rotation out to outer radius [degrees]
R4) -2.39       1       # Asymptotic spiral powerlaw
R9) 39.74       1       # Inclination to L.o.S. [degrees]
R10) 22.52      1       # Sky position angle

F1) 0.1500 46.4800 1  1 # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.1000 -33.0600 1  1 # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1133.43     1       # Sky background at center of fitting region [ADUs]
 2) 0.0116      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) -0.0135     1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

Did the good example succeed? True
********************************************************************************
********************************************************************************
Testing extraction into ComponentContainer...
#  Input menu file: .in

#  

================================================================================
# IMAGE and GALFIT CONTROL PARAMETERS
A) .fits                # Input data image (FITS file)
B) _galfit_out.fits     # Output data image block
C) none                 # Sigma image name (made from data if blank or 'none')
D) _psf.fits            # Input PSF image and (optional) diffusion kernel
E) 1                    # PSF fine sampling factor relative to data
F) _star-rm.fits        # Bad pixel mask (FITS image or ASCII coord list)
G) none                 # File with parameter constraints (ASCII file)
H) 0    256  0    256   # Image region to fit (xmin xmax ymin ymax)
I) 52     52            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 67.3800 67.7700 0  0 # Position x, y
 3) 13.19       1       # Integrated magnitude
 4) 15.54       1       # R_e (effective radius)   [pix]
 5) 0.34        1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.62        1       # Axis ratio (b/a)
 10) -19.23     1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 67.3800 67.7700 0  0 # Position x, y
 3) 14.58       1       # Integrated magnitude
 4) 8.89        1       # R_e (effective radius)   [pix]
 5) 1.56        1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.68        1       # Axis ratio (b/a)
 10) 30.23      1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 22.01       0       # Spiral outer radius [pixels]
R3) 78.86       1       # Cumul. rotation out to outer radius [degrees]
R4) -2.39       1       # Asymptotic spiral powerlaw
R9) 39.74       1       # Inclination to L.o.S. [degrees]
R10) 22.52      1       # Sky position angle

F1) 0.1500 46.4800 1  1 # Azim. Fourier mode 1, amplitude, & phase angle
F3) 0.1000 -33.0600 1  1 # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1133.43     1       # Sky background at center of fitting region [ADUs]
 2) 0.0116      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) -0.0135     1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)


observation
SIMPLE = True
BITPIX = -64
NAXIS = 2
NAXIS1 = 148
NAXIS2 = 148
CRVAL1 = 132.77287749
CRVAL2 = 11.05630315
RADESYS = FK5
EQUINOX = 2000.0
CTYPE1 = RA---TAN
CTYPE2 = DEC--TAN
CRPIX1 = 74.5
CRPIX2 = 74.5
CDELT1 = -0.00011
CDELT2 = 0.00011
COMMENT = 
 SkyView Survey metadata

Provenance:  Sloan Digital Sky Survey Team
Copyright:   See        Sloan usage document for distribution rights a
          nd acknowledgements.
Regime:      Optical
NSurvey:     5
Frequency:   490 THz
Coverage:    9,583 square degrees. The SDDS site provides coverage map
          s
PixelScale:  0.4"
PixelUnits:  ADUs
Resolution:  1"
Coordinates: Equatorial
Projection:  Tangent
Epoch:       ca. 2000
Reference:    Sloan Digital Sky Survey web site

Survey specific cards

These data are resampled from the Sloan Digital Sky Survey Data
available at www.sdss.org.
Image datasets were dynamically downloaded from the Sloan Site
and resampled into the projection requested by the user.
SURVEY = SDSS-r  DR7
HISTORY = 
 Settings used in processing:

coordinates = J2000.0
deedger = skyview.process.Deedger
equinox = 2000
finalpostprocessor = skyview.ij.IJProcessor,skyview.data.BoxSmoother,sky
imagefactory = skyview.survey.CachingImageFactory
imagesize = 0.25
lat = 11.05630315
lon = 132.77287749
mosaicker = skyview.process.Mosaicker
name = Sloan Digitized Sky Survey r-band
output = 1237671124296532233_3
pixels = 148
position = 132.77287749, 11.05630315
projection = Tan
reqxpos = 132.77287749
reqypos = 11.05630315
resolver = NED-SIMBAD
sampler = Default
scale = 0.00011
settingsupdaters = BatchCompatibility,SettingsFixer,skyview.request.Toas
shortname = SDSSdr7r,SDSSdr7 r
siabase = http://skyview.gsfc.nasa.gov/cgi-bin/images?
siapcoordinates = J2000
siapprojection = Tan
siapurl = http://casjobs.sdss.org/vo/DR7SIAP/SIAP.asmx/getSiapInfo?FORMA
size = 0.01628,0.01628
survey = SDSSdr7u,SDSSdr7g,SDSSdr7r,SDSSdr7i,SDSSdr7z
surveyfinder = skyview.survey.XMLSurveyFinder
surveymanifest = surveys/survey.manifest
url.heasarcbase = http://heasarc.gsfc.nasa.gov/xamin/vo/cone?table=
url.ned = http://nedwww.ipac.caltech.edu/cgi-bin/nph-NEDobjsearch?search
url.simbad = http://simbad.u-strasbg.fr/simbad-conesearch.pl?
url.vizierbase = http://vizier.u-strasbg.fr/viz-bin/votable/-dtd/-A?-out
urlcoordinates = http://heasarc.gsfc.nasa.gov/cgi-bin/Tools/convcoord/co
urllocalhelp = http://skyview.gsfc.nasa.gov/help/help.html

 Map generated at: Tue Dec 18 17:55:18 PST 2012

 Resampler used: NNSampler


Image mosaicking using skyview.geometry.Mosaicker

  Used image:.\skycache\fpC-005972-r4-0116.fit.gz

Img size: (148, 148)

#  Input menu file: .in

#  

================================================================================
# IMAGE and GALFIT CONTROL PARAMETERS
A) .fits                # Input data image (FITS file)
B) _galfit_out.fits     # Output data image block
C) none                 # Sigma image name (made from data if blank or 'none')
D) 1237671124296532233_psf.fits # Input PSF image and (optional) diffusion kernel
E) 1                    # PSF fine sampling factor relative to data
F) _star-rm.fits        # Bad pixel mask (FITS image or ASCII coord list)
G) none                 # File with parameter constraints (ASCII file)
H) 20   128  20   128   # Image region to fit (xmin xmax ymin ymax)
I) 50     50            # Size of the convolution box (x y)
J) 24.8                 # Magnitude photometric zeropoint
K) 0.396  0.396         # Plate scale (dx dy)   [arcsec per pixel]
O) regular              # Display type (regular, curses, both)
P) 0                    # Choose: 0=optimize, 1=model, 2=imgblock, 3=subcomps

# INITIAL FITTING PARAMETERS
#
#   For component type, the allowed functions are: 
#       sersic, expdisk, edgedisk, devauc, king, nuker, psf, 
#       gaussian, moffat, ferrer, and sky. 
#  
#   Hidden parameters will only appear when they're specified:
#       Bn (n=integer, Bending Modes).
#       C0 (diskyness/boxyness), 
#       Fn (n=integer, Azimuthal Fourier Modes).
#       R0-R10 (coordinate rotation, for creating spiral structures).
#       To, Ti, T0-T10 (truncation function).
# 
# ------------------------------------------------------------------------------
#   par)    par value(s)    fit toggle(s)    # parameter description 
# ------------------------------------------------------------------------------

# Component number: 1
 0) sersic              # Component type
 1) 73.8201 74.2847 0  0 # Position x, y
 3) 14.4655     1       # Integrated magnitude
 4) 11.9606     1       # R_e (effective radius)   [pix]
 5) 1.0225      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.5615      1       # Axis ratio (b/a)
 10) -2.9069    1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 2
 0) sersic              # Component type
 1) 73.8200 74.2800 0  0 # Position x, y
 3) 13.7671     1       # Integrated magnitude
 4) 23.4744     1       # R_e (effective radius)   [pix]
 5) 0.4464      1       # Sersic index n (de Vaucouleurs n=4)
 9) 0.4353      1       # Axis ratio (b/a)
 10) -87.8193   1       # Position angle (PA) [deg: Up=0, Left=90]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

R0) power               # Component type
R1) 0.0         0       # Spiral inner radius [pixels]
R2) 8.2001      0       # Spiral outer radius [pixels]
R3) -230.4884   1       # Cumul. rotation out to outer radius [degrees]
R4) 0.1411      1       # Asymptotic spiral powerlaw
R9) 55.6969     1       # Inclination to L.o.S. [degrees]
R10) 56.5248    1       # Sky position angle
F1) 0.0642 166.0134 1  1 # Azim. Fourier mode 1, amplitude, & phase angle
F3) -0.1451 43.4874 1  1 # Azim. Fourier mode 3, amplitude, & phase angle
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)

# Component number: 3
 0) sky                 # Component type
 1) 1084.9591   1       # Sky background at center of fitting region [ADUs]
 2) -0.002      1       # dsky/dx (sky gradient in x)     [ADUs/pix]
 3) 0.0009      1       # dsky/dy (sky gradient in y)     [ADUs/pix]
 Z) 0                   # Skip this model in output image?  (yes=1, no=0)


model
XTENSION = IMAGE
BITPIX = -32
NAXIS = 2
NAXIS1 = 109
NAXIS2 = 109
OBJECT = model
COMMENT = ========== GALFIT Input Parameters ==========
========== GALFIT Final Parameters ==========
------------------------------------------------------------------------
------------------------------------------------------------------------
------------------------------------------------------------------------
------------------------------------------------------------------------
=============================================

INITFILE = /home/portmanm/sparcfire_matt/GalfitModule/RegTest/TestOutput/test-o
DATAIN = /home/portmanm/sparcfire_matt/GalfitModule/RegTest/TestData/test-in/
SIGMA = none
PSF = 1237671124296532233_psf.fits
CONSTRNT = none
MASK = /home/portmanm/sparcfire_matt/GalfitModule/RegTest/TestOutput/test-t
FITSECT = [20:128,20:128]
CONVBOX = 50, 50
MAGZPT = 24.8
COMP_1 = sersic
1_XC = [73.8201]
1_YC = [74.2847]
1_MAG = 14.4655 +/- 0.0496
1_RE = 11.9606 +/- 0.4152
1_N = 1.0225 +/- 0.0281
1_AR = 0.5615 +/- 0.0183
1_PA = -2.9069 +/- 1.5305
COMP_2 = sersic
2_XC = [73.8200]
2_YC = [74.2800]
2_MAG = 13.7671 +/- 0.0278
2_RE = 23.4744 +/- 1.4306
2_N = 0.4464 +/- 0.0107
2_AR = 0.4353 +/- 0.0290
2_PA = -87.8193 +/- 68.2534
2_ROTF = power
2_RIN = [0.0000]
2_ROUT = [8.2001]
2_RANG = -230.4884 +/- 68.6326
2_ALPHA = 0.1411 +/- 0.0421
2_INCL = 55.6969 +/- 2.1821
2_SPA = 56.5248 +/- 1.3948
2_F1 = 0.0642 +/- 0.0046
2_F1PA = 166.0134 +/- 5.7221
2_F3 = -0.1451 +/- 0.0043
2_F3PA = 43.4874 +/- 1.2761
COMP_3 = sky
3_XC = [74.0000]
3_YC = [74.0000]
3_SKY = 1084.9591 +/- 0.0454
3_DSDX = -1.982e-03 +/- 1.128e-03
3_DSDY = 9.500e-04 +/- 1.135e-03
FLAGS = A-6 H-3 H-4 H-1 A-2 A-5
CHISQ = 11132.8013029998
NDOF = 11802
NFREE = 21
NFIX = 6
CHI2NU = 0.9432979
LOGFILE = galfit.02
Img size: (109, 109)

These should all be the same .
(109, 109)
(109, 109)
(109, 109)
(109, 109)
Andddd pre crop
(148, 148)
No bulge mask
Norm of the observation: 118341.5481
Norm of the model: 118339.6776
Norm of the residual: 495.2399
Norm of the masked residual: 0.0042
kstest p value: 0.0005
kstest statistic: 0.0263

Now with bulge mask
Norm of the observation: 118341.5481
Norm of the model: 118339.6776
Norm of the residual: 495.2399
Norm of the masked residual: 0.0042
kstest p value: 0.0005
kstest statistic: 0.0263
Checking FITS header update with NMR
Does the updated FITS file contain NMR and KStest keys?
Before... (expect False) False
After... True
================================================================================================================================================================